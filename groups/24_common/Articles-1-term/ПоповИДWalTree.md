**Wavelet Tree (–í–µ–π–≤–ª–µ—Ç-–¥–µ—Ä–µ–≤–æ)**


**1. –í–≤–µ–¥–µ–Ω–∏–µ**

Wavelet Tree (–≤–µ–π–≤–ª–µ—Ç-–¥–µ—Ä–µ–≤–æ) ‚Äî —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –º–∞—Å—Å–∏–≤–∞. –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞–∑–±–∏–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é. –ì–æ–≤–æ—Ä—è –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –º–∞—Å—Å–∏–≤–µ, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ—Ä—è–¥–∫–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á–∞—Å—Ç–æ—Ç–∞–º–∏ –∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏. –î–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∑–∞–¥–∞—á–∞—Ö —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–∞—Å—Å–∏–≤–æ–≤ –∏ —Ç–µ–æ—Ä–∏–∏ —Å—Ç—Ä–æ–∫.
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é –º–æ—â—å, Wavelet Tree —Ä–µ–¥–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –ø–∞–º—è—Ç–∏ –∏ –Ω–∞–ª–∏—á–∏–µ–º –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –∏ —É–¥–æ–±–Ω–µ–µ –≤ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–∏.


**2. –ß—Ç–æ –∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å —ç—Ç–æ –¥–µ—Ä–æ–≤–æ?**
Wavelet Tree –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
- –ø–æ–∏—Å–∫ k-–≥–æ –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ,
- –ø–æ–¥—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –º–µ–Ω—å—à–∏—Ö –∑–∞–¥–∞–Ω–Ω–æ–≥–æ,
- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —á–∏—Å–ª–∞ –Ω–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ.


**3. –ü—Ä–∏–Ω—Ü–∏–ø –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è**
–ü—É—Å—Ç—å –¥–∞–Ω –º–∞—Å—Å–∏–≤ `A` –∏–∑ `n` —ç–ª–µ–º–µ–Ω—Ç–æ–≤.  
–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
1. –í—ã–±–∏—Ä–∞–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π `[min, max]`.
2. –ù–∞ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–µ—Ä–µ–¥–∏–Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞:
   mid = (min + max) / 2
3. –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞:
   - –µ—Å–ª–∏ `A[i] ‚â§ mid`, –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ,
   - –∏–Ω–∞—á–µ ‚Äî –≤ –ø—Ä–∞–≤–æ–µ.
4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä–æ–∏—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ `B`, –≥–¥–µ:
   - `0` ‚Äî —ç–ª–µ–º–µ–Ω—Ç —É—à—ë–ª –≤–ª–µ–≤–æ,
   - `1` ‚Äî —ç–ª–µ–º–µ–Ω—Ç —É—à—ë–ª –≤–ø—Ä–∞–≤–æ.
5. –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ø–æ–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω –Ω–µ —Å–æ–∫—Ä–∞—Ç–∏—Ç—Å—è –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.


**4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
–ü—É—Å—Ç—å `n` —ç—Ç–æ –¥–∏–∞–ø–æ–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π, –∞ `k` —ç—Ç–æ —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞

## 4.1. –ü–æ–∏—Å–∫ k-–≥–æ –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ
–ó–∞–ø—Ä–æ—Å:
kth(l, r, k) –ù–∞—Ö–æ–¥–∏—Ç k-–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ `[l, r]`.
–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–∞:
–ø–æ –º–∞—Å—Å–∏–≤—É `B` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É—à–ª–æ –≤–ª–µ–≤–æ,
–µ—Å–ª–∏ `k` –º–µ–Ω—å—à–µ —ç—Ç–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ,
–∏–Ω–∞—á–µ ‚Äî –∏–¥—ë–º –≤ –ø—Ä–∞–≤–æ–µ.
–°–ª–æ–∂–Ω–æ—Å—Ç—å:  
**O(log n)**, –≥–¥–µ `n` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π.

## 4.2. –ü–æ–¥—Å—á—ë—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚â§ x –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ
–ó–∞–ø—Ä–æ—Å:
count(l, r, x) –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö `x` –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ.
–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–∞:
–ó–∞–ø—Ä–æ—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∑–Ω–∞—á–µ–Ω–∏–π `[min, max]`.
–ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ:
–µ—Å–ª–∏ `x` < `mid` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ;
–µ—Å–ª–∏ `x` ‚â• `mid`:
–≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –ª–µ–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ,
–∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ.
–ì—Ä–∞–Ω–∏—Ü—ã `[l, r]` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –±–∏—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤ `B`.
–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ª–∏—Å—Ç–∞.
–°–ª–æ–∂–Ω–æ—Å—Ç—å:  
**O(log n)**.

## 4.3. –ß–∞—Å—Ç–æ—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞
–ó–∞–ø—Ä–æ—Å:
freq(l, r, x) —É–∑–Ω–∞—ë—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —á–∏—Å–ª–æ `x` –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ.
–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–∞:
–ó–∞–ø—Ä–æ—Å —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–≤—É—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–∏–ø–∞ count, –∞ –∏–º–µ–Ω–Ω–æ
freq(l, r, x) = count(l, r, x) - count(l, r, x - 1)
–ö–∞–∂–¥—ã–π –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ count –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ O(log n).
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π —á–∏—Å–ª–∞ `x` –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ.
–°–ª–æ–∂–Ω–æ—Å—Ç—å:
**O(log n)**.


**5. –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –ø–∞–º—è—Ç—å**
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ: **O(k log n)**
- –ó–∞–ø—Ä–æ—Å—ã: **O(log n)**
- –ü–∞–º—è—Ç—å: **O(k log n)**
–ì–¥–µ:
- `k` ‚Äî —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞,
- `n` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π.
  
**–î–æ–∫–æ–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**

  Wavelet Tree —Å—Ç—Ä–æ–∏—Ç—Å—è –ø—É—Ç—ë–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ø–æ–ª–∞–º. –ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–µ—Ä–µ–¥–∏–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ª–∏–±–æ –≤ –ª–µ–≤–æ–µ, –ª–∏–±–æ –≤ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ –¥–≤–∞ —Ä–∞–∑–∞, –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Ä–∞–≤–Ω–∞ O(log(n)).
  
  –ü—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–µ–¥–∏–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ–Ω –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –∞ —Ç–∞–∫–∂–µ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ –±–∏—Ç–æ–≤–æ–º –º–∞—Å—Å–∏–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞. –í–∞–∂–Ω–æ, —á—Ç–æ –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ–º—É —É–∑–ª—É —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å—É–º–º–∞—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç (k). –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ —É—Ä–æ–≤–Ω–µ–π 
O(log(ùëõ)), –æ–±—â–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è Wavelet Tree —Ä–∞–≤–Ω–∞ O(ùëò log(n)).

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏ –∫ –æ—Ü–µ–Ω–∫–µ –ø–∞–º—è—Ç–∏. –í –∫–∞–∂–¥–æ–º —É–∑–ª–µ –¥–µ—Ä–µ–≤–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –±–∏—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤, –¥–ª–∏–Ω–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–≤–Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ —ç—Ç–æ—Ç —É–∑–µ–ª. –ù–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Å—É–º–º–∞—Ä–Ω–∞—è –¥–ª–∏–Ω–∞ –≤—Å–µ—Ö —Ç–∞–∫–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ —Ä–∞–≤–Ω–∞ k, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑. –¢–∞–∫ –∫–∞–∫ –¥–µ—Ä–µ–≤–æ —Å–æ–¥–µ—Ä–∂–∏—Ç O(log(n)) —É—Ä–æ–≤–Ω–µ–π, –æ–±—â–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç O(k log(n)).

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –ø–æ–∏—Å–∫–∞ k-–≥–æ –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ. –ó–∞–ø—Ä–æ—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –¥–µ—Ä–µ–≤–∞ –∏ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–æ–ø–∞–ª–æ –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –±–∏—Ç–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –∑–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è O(1). –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ª–∏–±–æ –≤ –ª–µ–≤–æ–µ, –ª–∏–±–æ –≤ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –ø—Ä–∏ —ç—Ç–æ–º –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–∞–∫–∂–µ –∑–∞ O(1). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏—à—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–π, –∏ –∑–∞–ø—Ä–æ—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ä–æ–≤–Ω–æ –ø–æ –æ–¥–Ω–æ–º—É –ø—É—Ç–∏ –æ—Ç –∫–æ—Ä–Ω—è –∫ –ª–∏—Å—Ç—É. –ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞ —Ä–∞–≤–Ω–∞ O(log(n)), —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–∏—Å–∫–∞ k-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Ç–∞–∫–∂–µ —Ä–∞–≤–Ω–∞ O(log(n)).

–ó–∞–ø—Ä–æ—Å –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ x, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å—Ö–æ–∂–µ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É. –û–Ω —Ç–∞–∫–∂–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –∏ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç x —Å —Å–µ—Ä–µ–¥–∏–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞. –ï—Å–ª–∏ x –º–µ–Ω—å—à–µ —ç—Ç–æ–π —Å–µ—Ä–µ–¥–∏–Ω—ã, –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –ï—Å–ª–∏ –∂–µ x –±–æ–ª—å—à–µ –ª–∏–±–æ —Ä–∞–≤–µ–Ω —Å–µ—Ä–µ–¥–∏–Ω–µ, —Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ª–µ–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã–π –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫, —Ü–µ–ª–∏–∫–æ–º —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ, –ø–æ—Å–ª–µ —á–µ–≥–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ. –í–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —á–∏—Å–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–π, –∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –¥–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(log(n)).

–ó–∞–ø—Ä–æ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–≤—É—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Å—á—ë—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π —á–∏—Å–ª–∞ x –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö x, –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö x ‚àí 1. –ö–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ O(log(n)), –∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã—á–∏—Ç–∞–Ω–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç O(1). –ü–æ—ç—Ç–æ–º—É –∏—Ç–æ–≥–æ–≤–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ —á–∞—Å—Ç–æ—Ç—ã —Ç–∞–∫–∂–µ —Ä–∞–≤–Ω–∞ O(log(n)).

**6. –ü—Ä–∏–º–µ—Ä**
–ü—É—Å—Ç—å –¥–∞–Ω –º–∞—Å—Å–∏–≤:
A = [3, 1, 4, 1, 5, 9, 2]
–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π:  
[min, max] = [1, 9]

### –®–∞–≥ 1. –ö–æ—Ä–Ω–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å
mid = 5
–†–∞–∑–±–∏–µ–Ω–∏–µ:
- –≤–ª–µ–≤–æ (‚â§ 5):  [3, 1, 4, 1, 5, 2]
- –≤–ø—Ä–∞–≤–æ (> 5): [9]
–ë–∏—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤:
B = [0, 0, 0, 0, 0, 1, 0]

### –®–∞–≥ 2. –£–∑–µ–ª [1, 5]
mid = 3
- ‚â§ 3 ‚Üí [3, 1, 1, 2]
- > 3 ‚Üí [4, 5]
B‚ÇÅ = [0, 0, 1, 0, 1, 0]

### –®–∞–≥ 3. –£–∑–µ–ª [1, 3]
mid = 2
- ‚â§ 2 ‚Üí [1, 1, 2]
- > 2 ‚Üí [3]
B‚ÇÇ = [1, 0, 0, 0]

### –®–∞–≥ 4. –£–∑–µ–ª [1, 2]
mid = 1
- ‚â§ 1 ‚Üí [1, 1]
- > 1 ‚Üí [2]
B‚ÇÉ = [0, 0, 1]


**7. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**
Wavelet Tree –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤:
- –ø–æ–∏—Å–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –ø–æ—Ä—è–¥–∫–∞,
- –æ–±—Ä–∞–±–æ—Ç–∫–µ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤,
- –∑–∞–¥–∞—á–∞—Ö –Ω–∞ –º–µ–¥–∏–∞–Ω—É,
- –∞–Ω–∞–ª–∏–∑–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π,
- —Å–∂–∞—Ç–∏–∏ –¥–∞–Ω–Ω—ã—Ö.


**8. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å.
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏.

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
- –ë–æ–ª—å—à–æ–π —Ä–∞—Å—Ö–æ–¥ –ø–∞–º—è—Ç–∏.
- –¢—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.


**9. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ**
Wavelet Tree ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–æ—á–µ—Ç–∞—é—â–∞—è –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∏ –º–µ—Ç–æ–¥—ã —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤. –û–Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –≤ –∑–∞–¥–∞—á–∞—Ö, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–æ—Ä—è–¥–∫–æ–≤—ã–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏ –Ω–∞ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞—Ö.


**10. –ò—Å—Ç–æ—á–Ω–∏–∫–∏**
1. Competitive Programming Handbook ‚Äî Antti Laaksonen  
2. cp-algoritm.ru ‚Äî Wavelet Tree  
3. GeeksForGeeks ‚Äî Wavelet Tree Data Structure  

4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è e-maxx.ru
